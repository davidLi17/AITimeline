# Runner - ä»£ç è¿è¡Œå™¨

## ğŸ“– åŠŸèƒ½ç®€ä»‹

Runner æ˜¯ä¸€ä¸ªå®‰å…¨çš„ä»£ç è¿è¡Œç¯å¢ƒï¼Œç”¨äºå¿«é€ŸéªŒè¯å’Œè¿è¡Œ AI ç”Ÿæˆçš„ä»£ç ç‰‡æ®µã€‚æ‰€æœ‰ä»£ç åœ¨éš”ç¦»çš„æ²™ç®±ï¼ˆsandbox iframeï¼‰ä¸­æ‰§è¡Œï¼Œç¡®ä¿å®‰å…¨æ€§ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### å½“å‰æ”¯æŒ

- âœ… **JavaScript æ‰§è¡Œ**ï¼šå®Œæ•´æ”¯æŒ ES6+ã€async/await
- âœ… **Console è¾“å‡º**ï¼šæ”¯æŒ log/error/warn/info/clear
- âœ… **æ²™ç®±éš”ç¦»**ï¼šä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥ï¼Œé˜²æ­¢æ¶æ„ä»£ç 
- âœ… **è¶…æ—¶æ§åˆ¶**ï¼š5ç§’è‡ªåŠ¨è¶…æ—¶
- âœ… **è¾“å‡ºé™åˆ¶**ï¼šæœ€å¤š1000æ¡è¾“å‡ºï¼Œé˜²æ­¢å¡é¡¿
- âœ… **é”™è¯¯æ•è·**ï¼šå®Œæ•´çš„é”™è¯¯å †æ ˆä¿¡æ¯
- âœ… **å¿«æ·å…¥å£**ï¼š
  - é¡µé¢å³ä¸‹è§’æµ®åŠ¨æŒ‰é’®ï¼Œç‚¹å‡»å³å¯æ‰“å¼€
  - `Ctrl/Cmd + Enter` è¿è¡Œä»£ç 

### æœªæ¥æ‰©å±•

- â³ Python æ”¯æŒï¼ˆä½¿ç”¨ Pyodideï¼‰
- â³ HTML/CSS é¢„è§ˆ
- â³ ä»£ç è¯­æ³•é«˜äº®
- â³ ä»£ç ç‰‡æ®µåº“

## ğŸ“‚ ç›®å½•ç»“æ„

```
js/runner/
â”œâ”€â”€ index.js                    # ä¸»å…¥å£
â”œâ”€â”€ runner-manager.js           # æ ¸å¿ƒç®¡ç†å™¨
â”œâ”€â”€ sandbox-manager.js          # æ²™ç®±ç®¡ç†å™¨
â”œâ”€â”€ languages/                  # è¯­è¨€è¿è¡Œæ—¶
â”‚   â”œâ”€â”€ javascript/
â”‚   â”‚   â””â”€â”€ index.js           # JS è¿è¡Œå™¨
â”‚   â””â”€â”€ registry.js            # è¯­è¨€æ³¨å†Œè¡¨
â”œâ”€â”€ styles.css                 # åŸºç¡€æ ·å¼
â””â”€â”€ README.md                  # æœ¬æ–‡æ¡£

panelModal/tabs/runner/
â”œâ”€â”€ index.js                   # Runner Tab UI
â””â”€â”€ styles.css                 # Tab æ ·å¼
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¨¡å—

#### 1. SandboxManagerï¼ˆæ²™ç®±ç®¡ç†å™¨ï¼‰
- åˆ›å»ºå’Œé”€æ¯éš”ç¦»çš„ iframe æ²™ç®±
- é€šè¿‡ postMessage è¿›è¡Œå®‰å…¨é€šä¿¡
- è¶…æ—¶æ§åˆ¶å’Œèµ„æºæ¸…ç†

#### 2. JavaScriptRunnerï¼ˆJSæ‰§è¡Œå™¨ï¼‰
- æ‰§è¡Œ JavaScript ä»£ç 
- åŠ«æŒ console æ–¹æ³•æ•è·è¾“å‡º
- æ”¯æŒå¼‚æ­¥ä»£ç ï¼ˆPromiseã€async/awaitï¼‰

#### 3. LanguageRegistryï¼ˆè¯­è¨€æ³¨å†Œè¡¨ï¼‰
- ç®¡ç†æ‰€æœ‰æ”¯æŒçš„è¯­è¨€è¿è¡Œå™¨
- æä¾›ç»Ÿä¸€çš„æ³¨å†Œå’ŒæŸ¥è¯¢æ¥å£
- æ”¯æŒåŠ¨æ€æ‰©å±•æ–°è¯­è¨€

#### 4. RunnerManagerï¼ˆæ ¸å¿ƒç®¡ç†å™¨ï¼‰
- åè°ƒå„ä¸ªæ¨¡å—å·¥ä½œ
- ç®¡ç†ä»£ç æ‰§è¡Œæµç¨‹
- å¤„ç†ç»“æœå’Œé”™è¯¯

#### 5. RunnerTabï¼ˆUIç»„ä»¶ï¼‰
- è¯­è¨€åˆ‡æ¢ Tabs
- ä»£ç ç¼–è¾‘å™¨ï¼ˆtextareaï¼‰
- è¾“å‡ºæ˜¾ç¤ºåŒºåŸŸ
- è¿è¡Œ/æ¸…ç©ºæŒ‰é’®

### é€šä¿¡æœºåˆ¶

**çˆ¶é¡µé¢ â†’ æ²™ç®±ï¼š**
```javascript
{
  type: 'EXECUTE_CODE',
  code: 'ç”¨æˆ·ä»£ç ',
  language: 'javascript'
}
```

**æ²™ç®± â†’ çˆ¶é¡µé¢ï¼š**
```javascript
// è¾“å‡º
{
  type: 'OUTPUT',
  data: { level: 'log', data: [...] }
}

// é”™è¯¯
{
  type: 'ERROR',
  data: { message: '...', stack: '...' }
}

// å®Œæˆ
{
  type: 'COMPLETE',
  data: { success: true, duration: 123 }
}
```

## ğŸ”’ å®‰å…¨ç­–ç•¥

### iframe sandbox å±æ€§
```html
<iframe sandbox="allow-scripts">
  <!-- åªå…è®¸è„šæœ¬æ‰§è¡Œ -->
  <!-- ç¦æ­¢è®¿é—® DOMã€localStorageã€cookies -->
  <!-- ç¦æ­¢ç½‘ç»œè¯·æ±‚ -->
  <!-- ç¦æ­¢è®¿é—®çˆ¶çª—å£ -->
</iframe>
```

### CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰
```html
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'none'; script-src 'unsafe-inline';">
```

### é™åˆ¶æªæ–½
- âŒ ç¦æ­¢è®¿é—®çˆ¶é¡µé¢
- âŒ ç¦æ­¢ç½‘ç»œè¯·æ±‚ï¼ˆfetch/XMLHttpRequestï¼‰
- âŒ ç¦æ­¢è®¿é—® localStorage/sessionStorage
- âŒ ç¦æ­¢è®¿é—® Chrome Extension API
- âœ… å…è®¸çº¯ JavaScript è®¡ç®—
- âœ… å…è®¸ console è¾“å‡º
- âœ… å…è®¸ setTimeout/setIntervalï¼ˆæ‰§è¡Œå®Œè‡ªåŠ¨æ¸…ç†ï¼‰

## ğŸ’» ä½¿ç”¨æ–¹å¼

### æµ®åŠ¨æŒ‰é’®ï¼ˆæ¨èï¼‰âš¡
1. **å¿«é€Ÿæ‰“å¼€**ï¼šç‚¹å‡»é¡µé¢å³ä¸‹è§’çš„ç´«è‰²æµ®åŠ¨æŒ‰é’®ï¼ˆä»£ç å›¾æ ‡ï¼‰
2. **è¾“å…¥ä»£ç **ï¼šåœ¨ç¼–è¾‘å™¨ä¸­ç¼–å†™ JavaScript ä»£ç 
3. **è¿è¡Œä»£ç **ï¼šæŒ‰ `Ctrl/Cmd + Enter` æˆ–ç‚¹å‡»"è¿è¡Œ"æŒ‰é’®
4. **æŸ¥çœ‹ç»“æœ**ï¼šå®æ—¶æŸ¥çœ‹è¾“å‡ºå’Œé”™è¯¯ä¿¡æ¯

### é€šè¿‡æ‰©å±•é¢æ¿
1. ç‚¹å‡»æ‰©å±•å›¾æ ‡æ‰“å¼€é¢æ¿
2. åˆ‡æ¢åˆ° "Runner" æ ‡ç­¾é¡µ
3. é€‰æ‹©è¯­è¨€ï¼ˆå½“å‰æ”¯æŒ JavaScriptï¼‰
4. è¾“å…¥ä»£ç 
5. ç‚¹å‡»"è¿è¡Œ"æˆ–æŒ‰ `Ctrl/Cmd + Enter`

### é€šè¿‡ API
```javascript
// è¿è¡Œä»£ç 
window.Runner.run(code, 'javascript', {
  onStart: () => console.log('å¼€å§‹æ‰§è¡Œ'),
  onOutput: (output) => console.log('è¾“å‡º:', output),
  onComplete: (result) => console.log('å®Œæˆ:', result),
  onError: (error) => console.error('é”™è¯¯:', error)
});

// åœæ­¢è¿è¡Œ
window.Runner.stop();

// æ¸…ç†èµ„æº
window.Runner.cleanup();
```

## ğŸ¨ UI è®¾è®¡

### æµ®åŠ¨æŒ‰é’®
```
é¡µé¢å³ä¸‹è§’ï¼š
    â”Œâ”€â”€â”€â”€â”
    â”‚ <> â”‚  â† ç´«è‰²æ¸å˜åœ†å½¢æŒ‰é’®
    â””â”€â”€â”€â”€â”˜     ç‚¹å‡»æ‰“å¼€ Runner
```

### Runner é¢æ¿
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Runner - ä»£ç è¿è¡Œå™¨                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [JavaScript] [Python] [HTML]    [â–¶ è¿è¡Œ] [æ¸…ç©º] â”‚
â”‚   â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾    (Soon)   (Soon)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»£ç ç¼–è¾‘å™¨                                     â”‚
â”‚  console.log('Hello, Runner!');                â”‚
â”‚  const result = 1 + 2;                         â”‚
â”‚  console.log(result);                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¤ è¾“å‡º                              âœ“ æˆåŠŸ(12ms)â”‚
â”‚  > Hello, Runner!                              â”‚
â”‚  > 3                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸŒ å›½é™…åŒ–

æ”¯æŒçš„ç¿»è¯‘é”®ï¼š
- `runnerTabTitle`: æ ‡ç­¾é¡µæ ‡é¢˜
- `runnerExecute`: è¿è¡ŒæŒ‰é’®
- `runnerClear`: æ¸…ç©ºæŒ‰é’®
- `runnerCodeEditor`: ä»£ç ç¼–è¾‘å™¨
- `runnerOutput`: è¾“å‡º
- `runnerHint`: æç¤ºä¿¡æ¯

## ğŸ”§ é…ç½®é¡¹

å¯ä»¥åœ¨ Settings æ ‡ç­¾é¡µä¸­é…ç½®ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰ï¼š
- æ‰§è¡Œè¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤5ç§’ï¼‰
- æœ€å¤§è¾“å‡ºè¡Œæ•°ï¼ˆé»˜è®¤1000è¡Œï¼‰
- æ˜¯å¦å¯ç”¨ä»£ç è¿è¡Œå™¨

## ğŸ“ ç¤ºä¾‹ä»£ç 

### JavaScript åŸºç¡€
```javascript
console.log('Hello, World!');

const numbers = [1, 2, 3, 4, 5];
const sum = numbers.reduce((a, b) => a + b, 0);
console.log('Sum:', sum);
```

### å¼‚æ­¥ä»£ç 
```javascript
async function fetchData() {
    return new Promise(resolve => {
        setTimeout(() => {
            resolve('Data loaded!');
        }, 1000);
    });
}

const data = await fetchData();
console.log(data);
```

### é”™è¯¯å¤„ç†
```javascript
try {
    throw new Error('This is an error');
} catch (error) {
    console.error('Caught:', error.message);
}
```

## ğŸ› å·²çŸ¥é™åˆ¶

1. ä¸æ”¯æŒç½‘ç»œè¯·æ±‚ï¼ˆfetch/XMLHttpRequestï¼‰
2. ä¸èƒ½è®¿é—®é¡µé¢ DOM
3. ä¸èƒ½è®¿é—®æµè§ˆå™¨å­˜å‚¨
4. æ‰§è¡Œæ—¶é—´é™åˆ¶ä¸º 5 ç§’
5. è¾“å‡ºé™åˆ¶ä¸º 1000 æ¡

## ğŸš€ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°è¯­è¨€æ”¯æŒ

1. åˆ›å»ºè¯­è¨€è¿è¡Œå™¨ï¼š
```javascript
class PythonRunner {
    constructor() {
        this.language = 'python';
        this.displayName = 'Python';
    }
    
    async execute(code, options) {
        // å®ç° Python æ‰§è¡Œé€»è¾‘
    }
}
```

2. æ³¨å†Œåˆ° LanguageRegistryï¼š
```javascript
// languages/registry.js
this.register('python', new window.PythonRunner());
```

3. æ›´æ–° UI é…ç½®ï¼š
```javascript
// languages/registry.js - getAllLanguages()
{
    id: 'python',
    name: 'Python',
    enabled: true,  // æ”¹ä¸º true
    icon: 'ğŸ'
}
```

## ğŸ“„ License

MIT

## ğŸ‘¨â€ğŸ’» ä½œè€…

yanchao hou

---

**æ³¨æ„**ï¼šRunner åŠŸèƒ½ä»…ç”¨äºå¿«é€ŸéªŒè¯ä»£ç ç‰‡æ®µï¼Œä¸é€‚åˆè¿è¡Œå¤§å‹ç¨‹åºæˆ–é•¿æ—¶é—´ä»»åŠ¡ã€‚

